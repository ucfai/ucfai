---
layout: "meeting"
title: "Introducing the NFL Big Data Bowl"
date: "2019-10-17"
authors:
    - "ahkerrigan"
    
categories: ['fa19']
tags: ['machine-learning', 'data science', 'football', 'competition']
description: >-
    AI@UCF has started its first data science competition! The National Football League's  $75,000 competition challenges you with using player stats, position, and time data to predict the future number of yards gained. Come join us as we dive into this competition and learn how to get started.
---
{% raw %}  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

  

  <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration -->
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Importing-Required-Libraries">Importing Required Libraries<a class="anchor-link" href="#Importing-Required-Libraries">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">kaggle.competitions</span> <span class="k">import</span> <span class="n">nflrush</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">LabelEncoder</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span><span class="n">BatchNormalization</span><span class="p">,</span><span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.optimizers</span> <span class="k">import</span> <span class="n">RMSprop</span><span class="p">,</span><span class="n">Adam</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="k">import</span> <span class="n">ReduceLROnPlateau</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
</pre>
</div>
</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-a-basic-Idea">Getting a basic Idea<a class="anchor-link" href="#Getting-a-basic-Idea">&#182;</a></h2><ul>
<li>Each row of the train dataframe contains the attributes of a single player in the match with the target value.</li>
<li>There are 22 players in a single game.</li>
<li>Each of this 22 player participating in game has a row.</li>
<li>This mean that we have 509762 / 22 = 23171 samples effectively.</li>
<li>There are many missing values in different columns,WindSpeed, WindDirection, Temperature, GameWeather, Humidity, StadiumType, and FieldPosition.</li>
<li>We will preprocess the data and make it in a trainable form.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setting-up-the-environment">Setting up the environment<a class="anchor-link" href="#Setting-up-the-environment">&#182;</a></h2><h4 id="Its-important-to-note-that-this-competition-has-its-own-API.">Its important to note that this competition has its own API.<a class="anchor-link" href="#Its-important-to-note-that-this-competition-has-its-own-API.">&#182;</a></h4><p>This time around, we aren't going to concatonate train and test, because the way data is handled
here is a little wonky. This means after we feature engineer and clean the train, we, yes, have
to do it all over again to the test.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># First, let&#39;s build the enviroment from the API</span>
<span class="n">env</span><span class="o">=</span><span class="n">nflrush</span><span class="o">.</span><span class="n">make_env</span><span class="p">()</span>
<span class="n">df_train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/nfl-big-data-bowl-2020/train.csv&#39;</span><span class="p">,</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GameId</th>
      <th>PlayId</th>
      <th>Team</th>
      <th>X</th>
      <th>Y</th>
      <th>S</th>
      <th>A</th>
      <th>Dis</th>
      <th>Orientation</th>
      <th>Dir</th>
      <th>...</th>
      <th>Week</th>
      <th>Stadium</th>
      <th>Location</th>
      <th>StadiumType</th>
      <th>Turf</th>
      <th>GameWeather</th>
      <th>Temperature</th>
      <th>Humidity</th>
      <th>WindSpeed</th>
      <th>WindDirection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>73.91</td>
      <td>34.84</td>
      <td>1.69</td>
      <td>1.13</td>
      <td>0.40</td>
      <td>81.99</td>
      <td>177.18</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>Clear and warm</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>SW</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>74.67</td>
      <td>32.64</td>
      <td>0.42</td>
      <td>1.35</td>
      <td>0.01</td>
      <td>27.61</td>
      <td>198.70</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>Clear and warm</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>SW</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>74.00</td>
      <td>33.20</td>
      <td>1.22</td>
      <td>0.59</td>
      <td>0.31</td>
      <td>3.01</td>
      <td>202.73</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>Clear and warm</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>SW</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>71.46</td>
      <td>27.70</td>
      <td>0.42</td>
      <td>0.54</td>
      <td>0.02</td>
      <td>359.77</td>
      <td>105.64</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>Clear and warm</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>SW</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>69.32</td>
      <td>35.42</td>
      <td>1.82</td>
      <td>2.43</td>
      <td>0.16</td>
      <td>12.63</td>
      <td>164.31</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>Clear and warm</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>SW</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>509757</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>86.77</td>
      <td>24.20</td>
      <td>2.14</td>
      <td>2.12</td>
      <td>0.22</td>
      <td>44.55</td>
      <td>15.31</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>Cloudy</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>SE</td>
    </tr>
    <tr>
      <td>509758</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>86.76</td>
      <td>27.18</td>
      <td>1.16</td>
      <td>0.66</td>
      <td>0.11</td>
      <td>53.63</td>
      <td>42.80</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>Cloudy</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>SE</td>
    </tr>
    <tr>
      <td>509759</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>87.26</td>
      <td>27.05</td>
      <td>2.59</td>
      <td>1.18</td>
      <td>0.26</td>
      <td>3.96</td>
      <td>21.12</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>Cloudy</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>SE</td>
    </tr>
    <tr>
      <td>509760</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>84.57</td>
      <td>24.37</td>
      <td>4.36</td>
      <td>1.79</td>
      <td>0.47</td>
      <td>148.08</td>
      <td>183.34</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>Cloudy</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>SE</td>
    </tr>
    <tr>
      <td>509761</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>80.80</td>
      <td>26.35</td>
      <td>4.87</td>
      <td>4.10</td>
      <td>0.45</td>
      <td>135.44</td>
      <td>118.24</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>Cloudy</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>SE</td>
    </tr>
  </tbody>
</table>
<p>509762 rows Ã— 49 columns</p>
</div>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The train dataframe contrains </span><span class="si">{}</span><span class="s1"> rows and </span><span class="si">{}</span><span class="s1"> columns&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">df_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stdout output_text">
<pre>The train dataframe contrains 509762 rows and 49 columns
</pre>
</div>
</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="handling-missing-values...">handling missing values...<a class="anchor-link" href="#handling-missing-values...">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>WindDirection             80234
WindSpeed                 67430
Temperature               48532
GameWeather               43648
StadiumType               32934
FieldPosition              6424
Humidity                   6160
OffenseFormation            110
DefendersInTheBox            66
Orientation                  18
Dir                          14
NflId                         0
PossessionTeam                0
GameClock                     0
Quarter                       0
YardLine                      0
Season                        0
JerseyNumber                  0
DisplayName                   0
Stadium                       0
Distance                      0
Dis                           0
A                             0
S                             0
Y                             0
X                             0
Team                          0
PlayId                        0
Down                          0
Turf                          0
Week                          0
Yards                         0
VisitorTeamAbbr               0
HomeTeamAbbr                  0
Position                      0
PlayerCollegeName             0
PlayerBirthDate               0
PlayerWeight                  0
PlayerHeight                  0
TimeSnap                      0
HomeScoreBeforePlay           0
TimeHandoff                   0
PlayDirection                 0
DefensePersonnel              0
OffensePersonnel              0
Location                      0
NflIdRusher                   0
VisitorScoreBeforePlay        0
GameId                        0
dtype: int64</pre>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-start-by-trying-to-fix-windspeed">Let's start by trying to fix windspeed<a class="anchor-link" href="#Let's-start-by-trying-to-fix-windspeed">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>5                    53284
6                    41580
7                    39578
4                    34584
9                    31328
10                   29788
8                    29370
3                    26862
2                    24112
12                   23584
11                   17116
15                   13926
0                    13772
1                    12078
16                    9878
13                    8404
14                    6094
17                    3872
18                    1980
13 MPH                1804
23                    1166
E                     1144
SE                    1122
7 MPH                 1100
Calm                  1100
10-20                 1100
12-22                 1056
6 mph                 1034
20                    1012
12mph                  968
24                     968
14-23                  968
4 MPh                  902
10mph                  902
10MPH                  902
SSW                    836
15 gusts up to 25      836
22                     836
11-17                  726
19                     660
Name: WindSpeed, dtype: int64</pre>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alright-so-this-data-is-not-very-consistent-with-how-wind-speed-is-labeled,-so-lets-fix-that">Alright so this data is not very consistent with how wind speed is labeled, so lets fix that<a class="anchor-link" href="#Alright-so-this-data-is-not-very-consistent-with-how-wind-speed-is-labeled,-so-lets-fix-that">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>There are many different type of values in Windspeed,we will clean them.</li>
<li>We will remove mph/MPH if its present</li>
<li>we will return average value if there is a range of values eg(11 - 15).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">windspeed</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>                             <span class="c1">#return 12 incase of 12mp or 12 MPH</span>
    <span class="k">elif</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>   <span class="c1"># return average windspeed incase of 11 - 20 etc..</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="We-are-going-to-use-a-very-nice-pandas-feature-that-YOU-ALL-should-know">We are going to use a very nice pandas feature that YOU ALL should know<a class="anchor-link" href="#We-are-going-to-use-a-very-nice-pandas-feature-that-YOU-ALL-should-know">&#182;</a></h3><p>By using .apply(function) to some column in a dataframe, you can apply that function individually to all items</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Let&#39;s just apply our fix to the messed up values </span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">windspeed</span><span class="p">)</span>
<span class="c1"># Then, lets just fill the missing values with the average, as we have been doing </span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7b33ef46d8&gt;</pre>
</div>

</div>


  
<div class="output_area">

    




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yeh,We have cleaned all the windspeed values.</p>
<h3 id="WindDirection-values">WindDirection values<a class="anchor-link" href="#WindDirection-values">&#182;</a></h3><p>Wind direction was much worse, so let's take a look at that</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindDirection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>NE                 30250
NW                 27236
SW                 25828
SE                 25784
WSW                24222
N                  23188
W                  22198
S                  21384
NNE                20394
South              20328
SSW                19910
WNW                19118
North              17182
NNW                14036
West               13618
SSE                13376
E                  12826
ENE                10802
ESE                 9878
East                7348
Northwest           4070
From SW             3872
Northeast           3652
NorthEast           3212
From S              3146
s                   2728
SouthWest           2134
Southeast           1936
W-NW                1804
Southwest           1804
West-Southwest      1386
8                   1144
1                   1122
North East          1100
East Southeast      1078
Calm                1056
West Northwest      1056
N-NE                1012
From W               990
North/Northwest      968
From NNE             968
W-SW                 968
From SSW             968
From WSW             946
South Southeast      946
From NNW             924
EAST                 902
From SSE             880
South Southwest      858
13                   836
East North East      748
from W               726
From ESE             682
Name: WindDirection, dtype: int64</pre>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># So wind direction is a bit confusing in that it is all base on WHERE it comes from</span>
<span class="c1"># We can see that it has the same problem as wind speed: multiple wants for saying the same thing.</span>
<span class="c1"># So we need to handle these cases indv</span>
<span class="c1"># We are going to reduce the number of options a bit </span>

<span class="k">def</span> <span class="nf">clean_wind_direction</span><span class="p">(</span><span class="n">wind_direction</span><span class="p">):</span>
    <span class="n">wd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">wind_direction</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">wd</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span> <span class="ow">or</span> <span class="s1">&#39;FROM N&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;north&#39;</span>
    <span class="k">if</span> <span class="n">wd</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span> <span class="ow">or</span> <span class="s1">&#39;FROM S&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;south&#39;</span>
    <span class="k">if</span> <span class="n">wd</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="ow">or</span> <span class="s1">&#39;FROM W&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;west&#39;</span>
    <span class="k">if</span> <span class="n">wd</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span> <span class="ow">or</span> <span class="s1">&#39;FROM E&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;east&#39;</span>
    
    <span class="k">if</span> <span class="s1">&#39;FROM SW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM SSW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM WSW&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;south west&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;FROM SE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM SSE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM ESE&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;south east&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;FROM NW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM NNW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM WNW&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;north west&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;FROM NE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM NNE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;FROM ENE&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;north east&#39;</span>
    
    <span class="k">if</span> <span class="s1">&#39;NW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;NORTHWEST&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;north west&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;NE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;NORTH EAST&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;north east&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;SW&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;SOUTHWEST&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;south west&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;SE&#39;</span> <span class="ow">in</span> <span class="n">wd</span> <span class="ow">or</span> <span class="s1">&#39;SOUTHEAST&#39;</span> <span class="ow">in</span> <span class="n">wd</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;south east&#39;</span>

    <span class="k">return</span> <span class="s1">&#39;none&#39;</span>

<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindDirection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_wind_direction</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Unhide above cell</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Handling-humidity-and-Temperature">Handling humidity and Temperature<a class="anchor-link" href="#Handling-humidity-and-Temperature">&#182;</a></h3><p>Since we are working with a time series, we have a nice benifit that there is a trick to filling empty vales
You can just use something called "forward filling", which just fills all empty values with the last known value
Say at 3:00pm I know that the temp was 80 degrees, and then didn't record for 10 hours
Forward will will just fill everything for the next 10 hours with 80 degrees</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Humidity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Handling-Game-wheather-and-Stadium-types">Handling Game wheather and Stadium types<a class="anchor-link" href="#Handling-Game-wheather-and-Stadium-types">&#182;</a></h3><p>For some other values, we are going to build what is called a na map
Its just a python dictionary that maps columns to the rule for filling t hem</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">na_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># What is the average orientation of the playrees</span>
    <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Orientation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="c1"># Average direction </span>
    <span class="s1">&#39;Dir&#39;</span><span class="p">:</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Dir&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="c1"># Average # of defenders in the box (# of defenders directly opposing person with the ball)</span>
    <span class="s1">&#39;DefendersInTheBox&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;DefendersInTheBox&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
    <span class="c1"># What formation the team is using is really important, but often some teams use custom formations</span>
    <span class="c1"># In the case we will just say that we don&#39;t know</span>
    <span class="s1">&#39;OffenseFormation&#39;</span><span class="p">:</span> <span class="s1">&#39;UNKNOWN&#39;</span>
<span class="p">}</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">na_map</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;GameWeather&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>Cloudy             114466
Sunny              105028
Partly Cloudy       46068
Clear               44264
Rain                18898
                    ...  
Rain Chance 40%       836
Party Cloudy          814
Sunny, Windy          792
Partly clear          770
Rainy                 704
Name: GameWeather, Length: 61, dtype: int64</pre>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Yeah this is insane, there are only 4 weather types that really matter
rain, overcast, clear, snow, and if players are climate controlled (indoors etc)
Here, we will make a function that first creates a list of all the different types we have 
(Unfortunately if you're doing this on your own you'll need to find each of these yourself)
Then, just determine which box the weather belongs to and change it to that</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">group_game_weather</span><span class="p">(</span><span class="n">weather</span><span class="p">):</span>
    <span class="n">rain</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Rainy&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain Chance 40%&#39;</span><span class="p">,</span> <span class="s1">&#39;Showers&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Cloudy with periods of rain, thunder possible. Winds shifting to WNW, 10-20 mph.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Scattered Showers&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy, Rain&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain shower&#39;</span><span class="p">,</span> <span class="s1">&#39;Light Rain&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain&#39;</span>
    <span class="p">]</span>
    <span class="n">overcast</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Cloudy, light snow accumulating 1-3&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;Party Cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy, chance of rain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Coudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy, 50</span><span class="si">% c</span><span class="s1">hange of rain&#39;</span><span class="p">,</span> <span class="s1">&#39;Rain likely, temps in low 40s.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Cloudy and cold&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy, fog started developing in 2nd quarter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Partly Clouidy&#39;</span><span class="p">,</span> <span class="s1">&#39;30% Chance of Rain&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly Coudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy and Cool&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Partly cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Overcast&#39;</span><span class="p">,</span> <span class="s1">&#39;Hazy&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly Cloudy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Partly Cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy&#39;</span>
    <span class="p">]</span>
    <span class="n">clear</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Partly clear&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunny and clear&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun &amp; clouds&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear and Sunny&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sunny and cold&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunny Skies&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear and Cool&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear and sunny&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sunny, highs to upper 80s&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly Sunny Skies&#39;</span><span class="p">,</span> <span class="s1">&#39;Cold&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Clear and warm&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunny and warm&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear and cold&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly sunny&#39;</span><span class="p">,</span>
        <span class="s1">&#39;T: 51; H: 55; W: NW 10 mph&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear Skies&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear skies&#39;</span><span class="p">,</span> <span class="s1">&#39;Partly sunny&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Fair&#39;</span><span class="p">,</span> <span class="s1">&#39;Partly Sunny&#39;</span><span class="p">,</span> <span class="s1">&#39;Mostly Sunny&#39;</span><span class="p">,</span> <span class="s1">&#39;Clear&#39;</span><span class="p">,</span> <span class="s1">&#39;Sunny&#39;</span>
    <span class="p">]</span>
    <span class="n">snow</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Heavy lake effect snow&#39;</span><span class="p">,</span> <span class="s1">&#39;Snow&#39;</span><span class="p">]</span>
    <span class="n">none</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;N/A Indoor&#39;</span><span class="p">,</span> <span class="s1">&#39;Indoors&#39;</span><span class="p">,</span> <span class="s1">&#39;Indoor&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A (Indoors)&#39;</span><span class="p">,</span> <span class="s1">&#39;Controlled Climate&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">weather</span> <span class="ow">in</span> <span class="n">rain</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;rain&#39;</span>
    <span class="k">elif</span> <span class="n">weather</span> <span class="ow">in</span> <span class="n">overcast</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;overcast&#39;</span>
    <span class="k">elif</span> <span class="n">weather</span> <span class="ow">in</span> <span class="n">clear</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;clear&#39;</span>
    <span class="k">elif</span> <span class="n">weather</span> <span class="ow">in</span> <span class="n">snow</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;snow&#39;</span>
    <span class="k">elif</span> <span class="n">weather</span> <span class="ow">in</span> <span class="n">none</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;none&#39;</span>
    
    <span class="k">return</span> <span class="s1">&#39;none&#39;</span>

<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;GameWeather&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;GameWeather&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">group_game_weather</span><span class="p">)</span>

<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;FieldPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;YardLine&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">50</span><span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;PossessionTeam&#39;</span><span class="p">],</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;FieldPosition&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stadium-types">Stadium types<a class="anchor-link" href="#Stadium-types">&#182;</a></h2><p>Again, let's reduce the number of stadiums types the same way we did with weather.
There is no difference between "Indoors" and "Indoor" obviously</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GameId</th>
      <th>PlayId</th>
      <th>Team</th>
      <th>X</th>
      <th>Y</th>
      <th>S</th>
      <th>A</th>
      <th>Dis</th>
      <th>Orientation</th>
      <th>Dir</th>
      <th>...</th>
      <th>Week</th>
      <th>Stadium</th>
      <th>Location</th>
      <th>StadiumType</th>
      <th>Turf</th>
      <th>GameWeather</th>
      <th>Temperature</th>
      <th>Humidity</th>
      <th>WindSpeed</th>
      <th>WindDirection</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>73.91</td>
      <td>34.84</td>
      <td>1.69</td>
      <td>1.13</td>
      <td>0.40</td>
      <td>81.99</td>
      <td>177.18</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>clear</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>south west</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>74.67</td>
      <td>32.64</td>
      <td>0.42</td>
      <td>1.35</td>
      <td>0.01</td>
      <td>27.61</td>
      <td>198.70</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>clear</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>south west</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>74.00</td>
      <td>33.20</td>
      <td>1.22</td>
      <td>0.59</td>
      <td>0.31</td>
      <td>3.01</td>
      <td>202.73</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>clear</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>south west</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>71.46</td>
      <td>27.70</td>
      <td>0.42</td>
      <td>0.54</td>
      <td>0.02</td>
      <td>359.77</td>
      <td>105.64</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>clear</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>south west</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2017090700</td>
      <td>20170907000118</td>
      <td>away</td>
      <td>69.32</td>
      <td>35.42</td>
      <td>1.82</td>
      <td>2.43</td>
      <td>0.16</td>
      <td>12.63</td>
      <td>164.31</td>
      <td>...</td>
      <td>1</td>
      <td>Gillette Stadium</td>
      <td>Foxborough, MA</td>
      <td>Outdoor</td>
      <td>Field Turf</td>
      <td>clear</td>
      <td>63.0</td>
      <td>77.0</td>
      <td>8</td>
      <td>south west</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>509757</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>86.77</td>
      <td>24.20</td>
      <td>2.14</td>
      <td>2.12</td>
      <td>0.22</td>
      <td>44.55</td>
      <td>15.31</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>overcast</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>south east</td>
    </tr>
    <tr>
      <td>509758</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>86.76</td>
      <td>27.18</td>
      <td>1.16</td>
      <td>0.66</td>
      <td>0.11</td>
      <td>53.63</td>
      <td>42.80</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>overcast</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>south east</td>
    </tr>
    <tr>
      <td>509759</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>87.26</td>
      <td>27.05</td>
      <td>2.59</td>
      <td>1.18</td>
      <td>0.26</td>
      <td>3.96</td>
      <td>21.12</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>overcast</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>south east</td>
    </tr>
    <tr>
      <td>509760</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>84.57</td>
      <td>24.37</td>
      <td>4.36</td>
      <td>1.79</td>
      <td>0.47</td>
      <td>148.08</td>
      <td>183.34</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>overcast</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>south east</td>
    </tr>
    <tr>
      <td>509761</td>
      <td>2018123015</td>
      <td>20181230154157</td>
      <td>home</td>
      <td>80.80</td>
      <td>26.35</td>
      <td>4.87</td>
      <td>4.10</td>
      <td>0.45</td>
      <td>135.44</td>
      <td>118.24</td>
      <td>...</td>
      <td>17</td>
      <td>CenturyLink Field</td>
      <td>Seattle, WA</td>
      <td>Outdoor</td>
      <td>FieldTurf</td>
      <td>overcast</td>
      <td>45.0</td>
      <td>76.0</td>
      <td>5</td>
      <td>south east</td>
    </tr>
  </tbody>
</table>
<p>509762 rows Ã— 49 columns</p>
</div>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">group_stadium_types</span><span class="p">(</span><span class="n">stadium</span><span class="p">):</span>
    <span class="n">outdoor</span>       <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Outdoor&#39;</span><span class="p">,</span> <span class="s1">&#39;Outdoors&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloudy&#39;</span><span class="p">,</span> <span class="s1">&#39;Heinz Field&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Outdor&#39;</span><span class="p">,</span> <span class="s1">&#39;Ourdoor&#39;</span><span class="p">,</span> <span class="s1">&#39;Outside&#39;</span><span class="p">,</span> <span class="s1">&#39;Outddors&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Outdoor Retr Roof-Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Oudoor&#39;</span><span class="p">,</span> <span class="s1">&#39;Bowl&#39;</span>
    <span class="p">]</span>
    <span class="n">indoor_closed</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Indoors&#39;</span><span class="p">,</span> <span class="s1">&#39;Indoor&#39;</span><span class="p">,</span> <span class="s1">&#39;Indoor, Roof Closed&#39;</span><span class="p">,</span> <span class="s1">&#39;Indoor, Roof Closed&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Retractable Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;Retr. Roof-Closed&#39;</span><span class="p">,</span> <span class="s1">&#39;Retr. Roof - Closed&#39;</span><span class="p">,</span> <span class="s1">&#39;Retr. Roof Closed&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">indoor_open</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Indoor, Open Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Retr. Roof-Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Retr. Roof - Open&#39;</span><span class="p">]</span>
    <span class="n">dome_closed</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Dome&#39;</span><span class="p">,</span> <span class="s1">&#39;Domed, closed&#39;</span><span class="p">,</span> <span class="s1">&#39;Closed Dome&#39;</span><span class="p">,</span> <span class="s1">&#39;Domed&#39;</span><span class="p">,</span> <span class="s1">&#39;Dome, closed&#39;</span><span class="p">]</span>
    <span class="n">dome_open</span>     <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Domed, Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Domed, open&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">stadium</span> <span class="ow">in</span> <span class="n">outdoor</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;outdoor&#39;</span>
    <span class="k">elif</span> <span class="n">stadium</span> <span class="ow">in</span> <span class="n">indoor_closed</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;indoor closed&#39;</span>
    <span class="k">elif</span> <span class="n">stadium</span> <span class="ow">in</span> <span class="n">indoor_open</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;indoor open&#39;</span>
    <span class="k">elif</span> <span class="n">stadium</span> <span class="ow">in</span> <span class="n">dome_closed</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;dome closed&#39;</span>
    <span class="k">elif</span> <span class="n">stadium</span> <span class="ow">in</span> <span class="n">dome_open</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;dome open&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;unknown&#39;</span>
    
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;StadiumType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;StadiumType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">group_stadium_types</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Unhide above cell</strong></p>
<ul>
<li>The stadium types and weather is cleaned.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="BirthDate,-GameHour-and-Time">BirthDate, GameHour and Time<a class="anchor-link" href="#BirthDate,-GameHour-and-Time">&#182;</a></h3><ul>
<li>we will extract and consider Birth year of each player</li>
<li>We will extract and consider Hour from GameClock</li>
<li>We will calucate TimeDelta by subtracting TimeSnap from TimeHandoff .</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">Z&quot;</span><span class="p">))</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">Z&quot;</span><span class="p">))</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;TimeDelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">,</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;BirthYear&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;PlayerBirthDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;GameHour&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;GameClock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PlayerBirthDate&#39;</span><span class="p">,</span><span class="s2">&quot;GameClock&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;PlayerHeight&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;PlayerHeight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)))))</span>
<span class="c1">#df_train.drop(&#39;PlayerHeight&#39;,axis=1,inplace=True)                                                       </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="DefensePersonnel">DefensePersonnel<a class="anchor-link" href="#DefensePersonnel">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We will split the DefensePersonnel variable into <strong>DL , LB ,  BL , OL</strong></li>
<li>We will filter them and store them as int variables.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_defense</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">num</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">num</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">dl</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">lb</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">db</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">):</span>
         <span class="n">ol</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
         <span class="n">ol</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dl</span><span class="p">,</span><span class="n">lb</span><span class="p">,</span><span class="n">db</span><span class="p">,</span><span class="n">ol</span><span class="p">]</span>

<span class="n">values</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;DefensePersonnel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">process_defense</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;DL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">u</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;LB&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;BL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">x</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;OL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;DefensePersonnel&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>(509762, 51)</pre>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Encoding-values..">Encoding values..<a class="anchor-link" href="#Encoding-values..">&#182;</a></h2><ul>
<li>In this step we will encode all categorical variables.</li>
<li>we will use Label Encoding for this.</li>
<li>we will store each of instances in a dictionary for later use during test set preparation.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_obj</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float16&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">new_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">lbdic</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">new_obj</span><span class="p">:</span>
    <span class="n">lb</span><span class="o">=</span><span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">lb</span><span class="o">=</span><span class="n">lb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">lbdic</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">lb</span>
    <span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">lb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-preparation">Data preparation<a class="anchor-link" href="#Data-preparation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the below session we will process and prepare data inorder to feed it to our model.</p>
<ul>
<li>First,we will drop some columns which are not relevant.</li>
<li>we will classify our varibles into three lists ,is one,two and more.</li>
<li>one contains variable having unique values.</li>
<li>more contains variables having more than 2 different values.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_drop</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GameId&#39;</span><span class="p">,</span><span class="s1">&#39;PlayId&#39;</span><span class="p">,</span><span class="s1">&#39;NflId&#39;</span><span class="p">,</span><span class="s1">&#39;NflIdRusher&#39;</span><span class="p">]</span>
<span class="n">one</span><span class="o">=</span><span class="p">[]</span>
<span class="n">two</span><span class="o">=</span><span class="p">[]</span>
<span class="n">more</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns_drop</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df_train</span><span class="p">[</span><span class="n">col</span><span class="p">][:</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">one</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">df_train</span><span class="p">[</span><span class="n">col</span><span class="p">][:</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">two</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">more</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of attributes for preprocessing =&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">one</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">two</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">more</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stdout output_text">
<pre>The number of attributes for preprocessing = 47
</pre>
</div>
</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>During the next steps we will actually convert the data to our required form.Each row in the output dataframe will represent a game.Our target variable is Yards,which is the the yardage gained on the play.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We&#39;re going to start by appending the variables that have more than two unique values</span>
<span class="c1"># Remember, every &quot;example&quot; is actually one of 11 timesteps from two seperate games, </span>
<span class="c1"># For a total of 22 datapoints per player</span>
<span class="n">new_cols</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">more</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
        <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;A&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
         <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;B&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        
        
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now we build the targets</span>
<span class="n">out</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">more</span><span class="p">:</span>
    <span class="k">for</span>  <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">):</span>
         <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">):</span><span class="mi">22</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
               
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_cols</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">))):</span>
    <span class="n">train</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">out</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">new_cols</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>XA0</th>
      <th>XA1</th>
      <th>XA2</th>
      <th>XA3</th>
      <th>XA4</th>
      <th>XA5</th>
      <th>XA6</th>
      <th>XA7</th>
      <th>XA8</th>
      <th>XA9</th>
      <th>...</th>
      <th>BirthYearB1</th>
      <th>BirthYearB2</th>
      <th>BirthYearB3</th>
      <th>BirthYearB4</th>
      <th>BirthYearB5</th>
      <th>BirthYearB6</th>
      <th>BirthYearB7</th>
      <th>BirthYearB8</th>
      <th>BirthYearB9</th>
      <th>BirthYearB10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>73.937500</td>
      <td>74.687500</td>
      <td>74.00000</td>
      <td>71.437500</td>
      <td>69.312500</td>
      <td>75.062500</td>
      <td>74.125000</td>
      <td>73.375000</td>
      <td>56.625000</td>
      <td>73.375000</td>
      <td>...</td>
      <td>1989.0</td>
      <td>1988.0</td>
      <td>1988.0</td>
      <td>1977.0</td>
      <td>1987.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1992.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>65.750000</td>
      <td>66.062500</td>
      <td>66.00000</td>
      <td>63.312500</td>
      <td>60.500000</td>
      <td>66.625000</td>
      <td>65.125000</td>
      <td>65.187500</td>
      <td>48.062500</td>
      <td>64.437500</td>
      <td>...</td>
      <td>1989.0</td>
      <td>1988.0</td>
      <td>1988.0</td>
      <td>1977.0</td>
      <td>1987.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1992.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>44.750000</td>
      <td>44.375000</td>
      <td>43.37500</td>
      <td>41.968750</td>
      <td>40.937500</td>
      <td>44.625000</td>
      <td>42.625000</td>
      <td>39.875000</td>
      <td>28.234375</td>
      <td>42.281250</td>
      <td>...</td>
      <td>1989.0</td>
      <td>1988.0</td>
      <td>1988.0</td>
      <td>1977.0</td>
      <td>1987.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1992.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>11.906250</td>
      <td>9.671875</td>
      <td>11.28125</td>
      <td>11.171875</td>
      <td>9.757812</td>
      <td>10.867188</td>
      <td>10.320312</td>
      <td>11.132812</td>
      <td>10.062500</td>
      <td>9.203125</td>
      <td>...</td>
      <td>1988.0</td>
      <td>1988.0</td>
      <td>1977.0</td>
      <td>1988.0</td>
      <td>1990.0</td>
      <td>1991.0</td>
      <td>1990.0</td>
      <td>1993.0</td>
      <td>1992.0</td>
      <td>1992.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>29.515625</td>
      <td>33.187500</td>
      <td>33.34375</td>
      <td>31.359375</td>
      <td>34.250000</td>
      <td>33.625000</td>
      <td>35.062500</td>
      <td>36.187500</td>
      <td>34.187500</td>
      <td>33.812500</td>
      <td>...</td>
      <td>1987.0</td>
      <td>1984.0</td>
      <td>1990.0</td>
      <td>1990.0</td>
      <td>1991.0</td>
      <td>1991.0</td>
      <td>1990.0</td>
      <td>1993.0</td>
      <td>1993.0</td>
      <td>1994.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 308 columns</p>
</div>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="In-the-next-step-we-will-group-our-dataframe-using-PlayId-and-select-values-from-columns-which-are-labelled-as-one.">In the next step we will group our dataframe using PlayId and select values from columns which are labelled as <strong>one</strong>.<a class="anchor-link" href="#In-the-next-step-we-will-group-our-dataframe-using-PlayId-and-select-values-from-columns-which-are-labelled-as-one.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_one</span><span class="o">=</span><span class="n">df_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;PlayId&#39;</span><span class="p">])[</span><span class="n">one</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_one</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">train</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="n">df_one</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets check our target variable distribution..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;Yards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7b282ddf60&gt;</pre>
</div>

</div>


  
<div class="output_area">

    




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">not_object</span><span class="o">=</span><span class="p">[]</span>
<span class="n">obj</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">more</span><span class="o">+</span><span class="n">one</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df_train</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
        <span class="n">not_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We will split our train and taget variables.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Split the features and target variables</span>
<span class="n">X</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Yards&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;Yards&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Keras-model">Keras model<a class="anchor-link" href="#Keras-model">&#182;</a></h2><ul>
<li>In this section we will use keras Sequencial models to build our model.</li>
<li>We will use Dropout and BatchNormalization.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_model</span><span class="p">():</span>
    <span class="n">model</span><span class="o">=</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">356</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">212</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">BatchNormalization</span><span class="p">())</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="o">.</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">199</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>

    <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">],</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="n">learning_rate_reduction</span> <span class="o">=</span> <span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> 
                                                <span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                                <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                                <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
                                                <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We will also convert our Target variable to appropriate form.Ie 199 x 1 array.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform_y</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">):</span>
    <span class="n">Y_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">199</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">yard</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_train</span><span class="p">):</span>
        <span class="n">Y_train</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">yard</span><span class="o">+</span><span class="mi">99</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">yard</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">Y_train</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="KFold-cross-validation..">KFold cross validation..<a class="anchor-link" href="#KFold-cross-validation..">&#182;</a></h2><p>Everyone remember how this works?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>
<span class="n">kfold</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">train_ind</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">kfold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    
    <span class="n">x_train</span><span class="p">,</span><span class="n">xval</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_ind</span><span class="p">],</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
    <span class="n">y_train</span><span class="p">,</span><span class="n">yval</span><span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_ind</span><span class="p">],</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
    
    <span class="n">y_train</span><span class="o">=</span><span class="n">transform_y</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_val</span><span class="o">=</span><span class="n">transform_y</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span><span class="n">yval</span><span class="p">)</span>
    
    <span class="n">model</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">model</span><span class="o">=</span><span class="n">create_model</span><span class="p">()</span>
    
    <span class="n">history</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">validation_data</span><span class="o">=</span><span class="p">[</span><span class="n">xval</span><span class="p">,</span><span class="n">y_val</span><span class="p">],</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;validation accuracy : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">])))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 15447 samples, validate on 7724 samples
Epoch 1/20
15447/15447 [==============================] - 7s 445us/step - loss: 0.0742 - accuracy: 0.0015 - val_loss: 0.0145 - val_accuracy: 2.5893e-04
Epoch 2/20
15447/15447 [==============================] - 5s 340us/step - loss: 0.0149 - accuracy: 1.2947e-04 - val_loss: 0.0142 - val_accuracy: 1.2947e-04
Epoch 3/20
15447/15447 [==============================] - 6s 367us/step - loss: 0.0145 - accuracy: 6.4737e-05 - val_loss: 0.0142 - val_accuracy: 2.5893e-04
Epoch 4/20
15447/15447 [==============================] - 6s 367us/step - loss: 0.0144 - accuracy: 6.4737e-05 - val_loss: 0.0141 - val_accuracy: 1.2947e-04
Epoch 5/20
15447/15447 [==============================] - 6s 364us/step - loss: 0.0143 - accuracy: 6.4737e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 6/20
15447/15447 [==============================] - 5s 350us/step - loss: 0.0143 - accuracy: 6.4737e-05 - val_loss: 0.0141 - val_accuracy: 1.2947e-04
Epoch 7/20
15447/15447 [==============================] - 5s 329us/step - loss: 0.0143 - accuracy: 1.2947e-04 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 8/20
15447/15447 [==============================] - 5s 340us/step - loss: 0.0142 - accuracy: 1.2947e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 9/20
15447/15447 [==============================] - 5s 346us/step - loss: 0.0142 - accuracy: 1.2947e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 10/20
15447/15447 [==============================] - 5s 347us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 11/20
15447/15447 [==============================] - 6s 371us/step - loss: 0.0142 - accuracy: 1.2947e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 12/20
15447/15447 [==============================] - 5s 355us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 13/20
15447/15447 [==============================] - 5s 350us/step - loss: 0.0142 - accuracy: 1.2947e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 14/20
15447/15447 [==============================] - 6s 370us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 15/20
15447/15447 [==============================] - 5s 355us/step - loss: 0.0141 - accuracy: 6.4737e-05 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 16/20
15447/15447 [==============================] - 5s 348us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 17/20
15447/15447 [==============================] - 5s 304us/step - loss: 0.0141 - accuracy: 6.4737e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 18/20
15447/15447 [==============================] - 6s 362us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 1.2947e-04
Epoch 19/20
15447/15447 [==============================] - 6s 357us/step - loss: 0.0140 - accuracy: 6.4737e-05 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 20/20
15447/15447 [==============================] - 5s 325us/step - loss: 0.0140 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
validation accuracy : 5.1786639960482714e-05
Train on 15447 samples, validate on 7724 samples
Epoch 1/20
15447/15447 [==============================] - 7s 459us/step - loss: 0.0745 - accuracy: 0.0014 - val_loss: 0.0147 - val_accuracy: 1.2947e-04
Epoch 2/20
15447/15447 [==============================] - 5s 342us/step - loss: 0.0148 - accuracy: 0.0000e+00 - val_loss: 0.0144 - val_accuracy: 0.0000e+00
Epoch 3/20
15447/15447 [==============================] - 5s 356us/step - loss: 0.0144 - accuracy: 1.9421e-04 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 4/20
15447/15447 [==============================] - 6s 376us/step - loss: 0.0143 - accuracy: 2.5895e-04 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 5/20
15447/15447 [==============================] - 5s 351us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 1.2947e-04
Epoch 6/20
15447/15447 [==============================] - 5s 340us/step - loss: 0.0142 - accuracy: 2.5895e-04 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 7/20
15447/15447 [==============================] - 6s 385us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 8/20
15447/15447 [==============================] - 6s 372us/step - loss: 0.0142 - accuracy: 1.2947e-04 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 9/20
15447/15447 [==============================] - 6s 381us/step - loss: 0.0142 - accuracy: 6.4737e-05 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 10/20
15447/15447 [==============================] - 6s 400us/step - loss: 0.0142 - accuracy: 6.4737e-05 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 11/20
15447/15447 [==============================] - 6s 370us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 12/20
15447/15447 [==============================] - 6s 371us/step - loss: 0.0141 - accuracy: 6.4737e-05 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 13/20
15447/15447 [==============================] - 6s 363us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 1.2947e-04
Epoch 14/20
15447/15447 [==============================] - 6s 391us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 15/20
15447/15447 [==============================] - 6s 359us/step - loss: 0.0141 - accuracy: 1.2947e-04 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 16/20
15447/15447 [==============================] - 6s 373us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
Epoch 17/20
15447/15447 [==============================] - 6s 372us/step - loss: 0.0140 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 18/20
15447/15447 [==============================] - 6s 384us/step - loss: 0.0140 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 1.2947e-04
Epoch 19/20
15447/15447 [==============================] - 6s 373us/step - loss: 0.0140 - accuracy: 6.4737e-05 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 20/20
15447/15447 [==============================] - 6s 392us/step - loss: 0.0140 - accuracy: 0.0000e+00 - val_loss: 0.0143 - val_accuracy: 0.0000e+00
validation accuracy : 2.5893319980241357e-05
Train on 15448 samples, validate on 7723 samples
Epoch 1/20
15448/15448 [==============================] - 7s 465us/step - loss: 0.0741 - accuracy: 0.0020 - val_loss: 0.0145 - val_accuracy: 0.0000e+00
Epoch 2/20
15448/15448 [==============================] - 6s 388us/step - loss: 0.0149 - accuracy: 1.2947e-04 - val_loss: 0.0142 - val_accuracy: 1.2948e-04
Epoch 3/20
15448/15448 [==============================] - 6s 371us/step - loss: 0.0145 - accuracy: 6.4733e-05 - val_loss: 0.0142 - val_accuracy: 1.2948e-04
Epoch 4/20
15448/15448 [==============================] - 6s 376us/step - loss: 0.0144 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 1.2948e-04
Epoch 5/20
15448/15448 [==============================] - 6s 360us/step - loss: 0.0143 - accuracy: 6.4733e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 6/20
15448/15448 [==============================] - 6s 383us/step - loss: 0.0143 - accuracy: 1.2947e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 7/20
15448/15448 [==============================] - 5s 354us/step - loss: 0.0143 - accuracy: 1.9420e-04 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 8/20
15448/15448 [==============================] - 5s 341us/step - loss: 0.0142 - accuracy: 6.4733e-05 - val_loss: 0.0141 - val_accuracy: 2.5897e-04
Epoch 9/20
15448/15448 [==============================] - 6s 375us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 2.5897e-04
Epoch 10/20
15448/15448 [==============================] - 6s 386us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 1.2948e-04
Epoch 11/20
15448/15448 [==============================] - 5s 325us/step - loss: 0.0142 - accuracy: 1.9420e-04 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 12/20
15448/15448 [==============================] - 6s 382us/step - loss: 0.0142 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 1.2948e-04
Epoch 13/20
15448/15448 [==============================] - 5s 355us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 1.2948e-04
Epoch 14/20
15448/15448 [==============================] - 6s 387us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 15/20
15448/15448 [==============================] - 6s 368us/step - loss: 0.0141 - accuracy: 6.4733e-05 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 16/20
15448/15448 [==============================] - 5s 349us/step - loss: 0.0141 - accuracy: 0.0000e+00 - val_loss: 0.0142 - val_accuracy: 0.0000e+00
Epoch 17/20
15448/15448 [==============================] - 6s 375us/step - loss: 0.0140 - accuracy: 6.4733e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 18/20
15448/15448 [==============================] - 6s 367us/step - loss: 0.0140 - accuracy: 0.0000e+00 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 19/20
15448/15448 [==============================] - 5s 338us/step - loss: 0.0140 - accuracy: 6.4733e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
Epoch 20/20
15448/15448 [==============================] - 6s 377us/step - loss: 0.0140 - accuracy: 6.4733e-05 - val_loss: 0.0141 - val_accuracy: 0.0000e+00
validation accuracy : 6.474168185377494e-05
</pre>
</div>
</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We will also use learning rate reducer to reduce learning rate and help it converge easily to minima point.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Evaluation">Model Evaluation<a class="anchor-link" href="#Model-Evaluation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">epochs</span><span class="o">=</span><span class="mi">20</span>
<span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">epochs</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;trainng loss&#39;</span><span class="p">,</span><span class="s1">&#39;validation loss&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;trainng acc&#39;</span><span class="p">,</span><span class="s1">&#39;validation acc&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of epochs&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;accuracy&#39;)</pre>
</div>

</div>


  
<div class="output_area">

    




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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wrmOU3RycqwGbIyJmbglYFUtxV3fawawDJisqktE5F4RGeQVew7I8v5k+z1ezwVVXQJMxv259i5wo6qWAT2By4Gficgi73aOt60HgZ+LyHLg597j2MrNdQm4vDzmmzYm2Wzfvp2nn366Wuuec845bN++PcYRHXnieiacusuKTw+Yd5ff9D7gwhDr3g/cHzDvE4K3D6OqW4F+UYZcuZwc2L8fNmyA44+P666MSTRfAh4xYsRhy8rKykhNTQ257vTp00MuMwfZmXCR8P3Tae3A5igwZswYVq5cSefOnbn11luZPXs2ffv25de//jUdO3YE4LzzzuO0006jQ4cOTJgwoWLdnJwctmzZwurVqzn11FO57rrr6NChA/3792fv3r0A9OnTh9GjR9OtWzdOOukkPv74YwBKSkq46KKLyM/P5+KLL6Z79+5Bhwy49957Of3008nLy2P48OG+KxWzYsUKzj77bDp16kTXrl1ZuXIlAOPGjaNjx4506tSJMWOS4zSBo3osiIj5EvDq1dCzZ0JDMUeZUaNg0aLYbrNzZ3jiiZCLH3zwQYqKiljk7Xf27NnMmzePoqKiim5XEydOpGnTpuzdu5fTTz+dCy64gKysrEO2s3z5cl555RWeffZZLrroIl5//XUuu+wyAEpLS5k3bx7Tp0/nnnvuYebMmTz99NNkZmayePFiioqK6Ny5c9D4Ro4cyV13uR/Ul19+OW+//Tbnnnsul156KWPGjGHIkCHs27eP8vJy3nnnHaZOncrcuXOpV68eP/zwQ9SHLxasBhyJ7Gx3bzVgc5Tq1q3bIX1en3zySTp16kSPHj1Ys2YNy5cvP2yd3NzciiR62mmnsdrvj+zzzz//sPmffPIJhYWFAOTl5ZGfnx80llmzZtG9e3c6duzIhx9+yJIlS9i1axdr165lyJAhgDtRol69esycOZNhw4ZRr149AJo2bRrdgYgRqwFH4phj4LjjrCeEqXmV1FRrUv369SumZ8+ezcyZM/n000+pV68effr0Cdontm7duhXTqampFU0Q/stSU1MpLS0FqGhKqMy+ffsYMWIECxYsoHXr1owdO5Z9+/aFXFdVk7JLn9WAI5WTYzVgc1Ro2LAhu3btCrl8x44dZGZmUq9ePb766is+++yzkGUjceaZZzJ58mQAli5dypdffnlYGV+ib9asGbt372bKlCkANGrU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
"
>
</div>

</div>


</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have lot to improve !</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Making-Prediction..">Making Prediction..<a class="anchor-link" href="#Making-Prediction..">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>This function is to prepare and predict on test data.</li>
<li>We will have to replicate all the data processing steps that we have done above in this function.</li>
<li>This ensures that our data is made fit for prediction.</li>
<li>In this competition we will have to use <strong>env.iter_test()</strong> and <strong>env.predict()</strong>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_prediction</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">df_train</span><span class="p">):</span>
    
    <span class="n">na_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Orientation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="s1">&#39;Dir&#39;</span><span class="p">:</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Dir&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="s1">&#39;DefendersInTheBox&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
    <span class="s1">&#39;OffenseFormation&#39;</span><span class="p">:</span> <span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">:</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">test</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">na_map</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">61.0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;WindSpeed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">windspeed</span><span class="p">)</span>
    <span class="c1">#test[&#39;WindSpeed&#39;].fillna(df_train[&#39;WindSpeed&#39;].mean(),inplace=True)</span>

    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;GameWeather&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;GameWeather&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">group_game_weather</span><span class="p">)</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;FieldPosition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;YardLine&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">50</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;PossessionTeam&#39;</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;FieldPosition&#39;</span><span class="p">])</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;StadiumType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;StadiumType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">group_stadium_types</span><span class="p">)</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;WindDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;WindDirection&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">clean_wind_direction</span><span class="p">)</span>
    
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">Z&quot;</span><span class="p">))</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S.</span><span class="si">%f</span><span class="s2">Z&quot;</span><span class="p">))</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;TimeDelta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;TimeSnap&#39;</span><span class="p">,</span><span class="s1">&#39;TimeHandoff&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
   
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;PlayerHeight&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;PlayerHeight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)))))</span>




    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;BirthYear&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;PlayerBirthDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;GameHour&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;GameClock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PlayerBirthDate&#39;</span><span class="p">,</span><span class="s2">&quot;GameClock&quot;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">values</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;DefensePersonnel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">process_defense</span><span class="p">)</span>
    <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)))</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;DL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">u</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;LB&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">v</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;BL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">x</span>
    <span class="n">test</span><span class="p">[</span><span class="s1">&#39;OL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">y</span>
    <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;DefensePersonnel&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">new_obj</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float16&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">new_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">new_obj</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">lbdic</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">l</span><span class="o">=</span><span class="n">LabelEncoder</span><span class="p">()</span>
            <span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            
    
    <span class="n">columns_drop</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GameId&#39;</span><span class="p">,</span><span class="s1">&#39;PlayId&#39;</span><span class="p">,</span><span class="s1">&#39;NflId&#39;</span><span class="p">,</span><span class="s1">&#39;NflIdRusher&#39;</span><span class="p">]</span>
    <span class="n">one</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">two</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">more</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns_drop</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">][:</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">one</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">][:</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">two</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">more</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        

    <span class="n">new_cols</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">more</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
            <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;A&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
             <span class="n">new_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;B&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    

    <span class="n">out</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">more</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    
   
    <span class="n">new_out</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">new_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

    <span class="n">new_test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">new_out</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="n">new_cols</span><span class="p">)</span>

    <span class="n">df_one</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;PlayId&#39;</span><span class="p">])[</span><span class="n">one</span><span class="p">]</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_one</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">new_test</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="n">df_one</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    
    <span class="n">new_test</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">na_map</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">new_test</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">61.0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">199</span><span class="p">))</span>
    
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_test</span><span class="p">)</span>
    
        
    <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">:</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">prev</span><span class="p">:</span>
                <span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">prev</span>
            <span class="n">prev</span><span class="o">=</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">y_pred</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">y_pred</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
  
    <span class="n">pred</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">env</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_pred</span>

        
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Submitting-to-competition..">Submitting to competition..<a class="anchor-link" href="#Submitting-to-competition..">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">test</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">iter_test</span><span class="p">()):</span>
    <span class="n">make_prediction</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">df_train</span><span class="p">)</span>
    
<span class="n">env</span><span class="o">.</span><span class="n">write_submission_file</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stderr output_text">
<pre>3438it [09:57,  5.76it/s]
</pre>
</div>
</div>


  
<div class="output_area">

    


<div class="output_subarea output_stream output_stdout output_text">
<pre>Your submission file has been saved!  Once you `Commit` your Notebook and it finishes running, you can submit the file to the competition from the Notebook Viewer `Output` tab.
</pre>
</div>
</div>


</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">


<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
  
 


{% endraw %}